!function($,t,i,e){"use strict";function n(t,i){this.element=t,this.settings=$.extend({},r,i),this._defaults=r,this._name=o,this.init()}var o="neverEnding",s=t.location.protocol+"//"+t.location.host+"/",r={article:"article",floor:"#footer",data:null},l=!1,h=!1;$.extend(n.prototype,{init:function(){this.threshold=Math.ceil(.4*t.innerHeight),this.siteFloor=this.getSiteFloor(),this.fetch(),this.scroller()},debouncer:function(t,i,e){var n;return function(){var o=this,s=arguments,r=function(){n=null,e||t.apply(o,s)},l=e&&!n;clearTimeout(n),n=setTimeout(r,i),l&&t.apply(o,s)}},getSiteAPI:function(){return this.settings.data},getArticles:function(){return $(this.element).find(this.settings.article)},getPostURL:function(t){return s+this.getSiteAPI().posts[t].address+".html"},getPrevArticle:function(){for(var t=this.getArticles().last(),i,e=t.data("article").id-1,n=this.getSiteAPI(),o=n.posts.length-1;o>=0;o--)n.posts[o].id===e&&(i=this.getPostURL(o));return{id:e,url:i}},getSiteFloor:function(){var t=this.settings.floor;return t.jquery?t:$(t)},visible:function(e){e instanceof jQuery&&(e=e[0]);var n=e.getBoundingClientRect();return n.bottom>0&&n.right>0&&n.left<(t.innerWidth||i.documentElement.clientWidth)&&n.top<(t.innerHeight||i.documentElement.clientHeight)},proceed:function(){return l||h||!this.visible(this.siteFloor)?void 0:this.getPrevArticle().id<=0?void(h=!0):!0},fetch:function(){if(this.proceed()){var t=this.element.id,i=this.getArticles();$.ajax({url:this.getPrevArticle().url,type:"GET",dataType:"html",beforeSend:function(){l=!0}}).done(function(e){i.last().after(function(){return e?$(e).find("#"+t).html():void 0}),Prism.highlightAll()}).always(function(){l=!1})}},history:function(){if(History.enabled){var i=this;this.getArticles().each(function(i,e){var n=Math.floor(e.offsetTop-$(t).scrollTop());if(!(n>this.threshold)){for(var o=this.getSiteAPI().posts,s=$(e).data("article").id,r,l=o.length-1;l>=0;l--)o[l].id===s&&(r=l);var h=Math.floor(-1*(e.clientHeight-1.4*this.threshold)),c=this.getPostURL(r);n>h&&t.location.href!==c&&History.pushState(null,this.getSiteAPI().posts[r].title,c)}}.bind(this))}},scroller:function(){t.addEventListener("scroll",this.debouncer(function(){this.fetch()},100).bind(this),!1),t.addEventListener("scroll",function(){this.history()}.bind(this),!1)}}),$.fn[o]=function(t){return this.each(function(){$.data(this,"plugin_"+o)||$.data(this,"plugin_"+o,new n(this,t))})}}(jQuery,window,document);
//# sourceMappingURL=./script.jquery.pkg.js.map